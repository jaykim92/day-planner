<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
      integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <title>Work Day Scheduler</title>
  </head>

  <body>
    <header class="jumbotron">
      <h1 class="display-3">Work Day Scheduler</h1>
      <p class="lead">A simple calendar app for scheduling your work day</p>
      <p id="currentDay" class="lead"></p>
    </header>
    <div class="container">
      <!-- Timeblocks go here -->
    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>

    <script>

        $(document).ready(function () {

        // get date from moment and display at the top of the page
        const date = moment().format("MMMM Do YYYY");
        $("#currentDay").text(date);

        // get the time to be used as a reference for classes: past, present, and future
        const hour = moment().format('H');
        const todo = localStorage.getItem('todos') ? JSON.parse(localStorage.getItem('todos')) : {}

        for (var h = 9; h < 18; h++) {
            // make a row for each hour from 9am to 6pm
            var rowDiv = $("<div>"); 
            rowDiv.addClass("row");
                // make containers within each row
                var hourEl = $("<div>");
                // ternary statements for starting over from 1pm after 12 pm
                // add am or pm depending on the time
                //check if the statement "hour is less than 12" is truthy, if so, return the hour and concatonate with am
                // else if "h is 12" is truthy, then return exactly 12 pm
                // else means it's past 1pm or later, which means we need to do the military time - 12 hours and concatonate pm
                hourEl.addClass("col-md-2 hour").text( h<12 ? `${h}am` : h === 12 ? '12pm' : `${h-12}pm`);

                // add rows to the time-block container
                var textInput = $("<textarea>");
                // use ternary statements for color coding past, present, and future text areas
                textInput.addClass(`col-md-8 ${h<hour ? "past" : h === hour ? "present" : "future"}`);
                textInput.attr('id', h);
                textInput.text(todo[h])
                //make a save button for each row
                var saveBtn = $("<button>");
                saveBtn.addClass("col-md-2 saveBtn");
                saveBtn.on("click", function(){
                  console.log('clicked!')
                  var toDoItem = $(this).siblings("textarea").val();
                  var key = $(this).siblings("textarea").attr('id');
                  todo[key] = toDoItem;
                  localStorage.setItem('todos', JSON.stringify(todo));
                })

                // append to html to print on the page
                $(".container").append(rowDiv);
                rowDiv.append(hourEl);
                rowDiv.append(textInput);
                rowDiv.append(saveBtn);
        }

        // upon clock of any given time block, you can edit text that will save in local storage when save button is pressed

        // get items from local storage so that they stay even when the page is refreshed
        });

    </script>
  </body>
</html>
